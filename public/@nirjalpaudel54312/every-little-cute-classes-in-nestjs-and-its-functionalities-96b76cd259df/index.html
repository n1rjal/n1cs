<!doctype html>































<html
  class="not-ready lg:text-base"
  style="--bg: #faf8f1"
  lang="en-us"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>Every Class in NestJS and Its Functionalities - My New Hugo Site</title>

  
  <meta name="theme-color" />

  
  
  
  
  <meta name="description" content="NestJS is a huge framework built on top of TypeScript, JavaScript also uses Express or Fasitfy as an underlying mechanism to route requests. It uses decorator-based syntax and the concept in NestJS is similar to that of Angular. The source code looks similar to that of Spring boot, Dotnet MVC. Similar in the sense that they all follow dependency injection and IOC principles.
Nestjs is heavily inspired by Angular
I am trying to conclude the documentation of NestJS which can be found here." />
  <meta name="author" content="My New Hugo Site" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="http://localhost:1313/main.min.css" />

  
  
  
  
  
  <link rel="preload" as="image" href="http://localhost:1313/theme.png" />

  
  
  
  
  

  
  
  

  
  
  <script
    defer
    src="http://localhost:1313/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
  
  

  
  <link rel="icon" href="http://localhost:1313/favicon.ico" />
  <link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png" />

  
  <meta name="generator" content="Hugo 0.126.1">

  
  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center">
  <div class="relative z-50 mr-auto flex items-center">
    <a
      class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold"
      href="http://localhost:1313/"
      >My New Hugo Site</a
    >
    <div
      class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    

    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"
    >
      

<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">Every Class in NestJS and Its Functionalities</h1>

    
  </header>

  <section><p>NestJS is a huge framework built on top of TypeScript, JavaScript also uses Express or Fasitfy as an underlying mechanism to route requests. It uses decorator-based syntax and the concept in NestJS is similar to that of Angular. The source code looks similar to that of Spring boot, Dotnet MVC. Similar in the sense that they all follow dependency injection and IOC principles.</p>
<blockquote>
<p>Nestjs is heavily inspired by Angular</p>
</blockquote>
<p>I am trying to conclude the documentation of NestJS which can be found here. <a href="https://docs.nestjs.com/">https://docs.nestjs.com/</a> in this writing.</p>
<p><img src="/Users/nirjalpaudel/Downloads/me/posts/md_1717232175977/img/1__VTSKq5eIs3KyOyLYShI67Q.png" alt=""></p>
<p>I have been working on a code base built on nestjs for the last 3 years and I have seen how things changed over time in nestjs. Now, lets leave me out of the discussion and lets disscuss on tiny cute classes in nestjs and its functionalities. Shall we¬†?</p>
<ol>
<li><strong>Controller</strong></li>
</ol>
<p>Controller as name suggest is a class that are used to define our routes to the class. It‚Äôs is decorated with Controller class and the decorator expects a url path string that will trigger its excution. Every methods in controllers are decorated with method specific decorators like Get, Post, Patch, Put, Delete and it assumes you provide it with a path.</p>
<p>@Controller(&rsquo;/user&rsquo;)<br>
export class UserController {<br>
constructor(private readonly userService: UserService) {}</p>
<p>// to signup user<br>
// GET: <!-- raw HTML omitted -->/user/signUp<br>
@Post(&lsquo;signup&rsquo;)<br>
@Public()<br>
async signUpUser(@Body() signUpUserDto: SignUpUserDto) {<br>
return this.userService.signUpUser(signUpUserDto);<br>
}</p>
<p>// to get user profile<br>
// GET: <!-- raw HTML omitted -->/user/profile<br>
@Get(&lsquo;profile&rsquo;)<br>
async getUserProfile(@LoggedInUser() user: User) {<br>
return user;<br>
}</p>
<p>}</p>
<p>Each of the methods can also be decorated with decorators like @Body, @Query, or @Param that puts request body, query params or url path params into it. Each one of it expects a string to be provided to it which will map the string to the value there. See how userService is provided in controller and how it is being called even without an instance of it being provided.</p>
<p><strong>2. Service</strong></p>
<p>Service is where our business logic resides. Generally, services are injected with other services or repository layers. Here is an example of service in Nestjs. Now here you can see that it has some other services and repositories in its parameter.</p>
<p>You saw the same in controllers as well, the object will be in place all thanks to Dependency injection and IOC container.</p>
<p>@Injectable()<br>
export class UserService {<br>
constructor(    @InjectRepository(User)<br>
private readonly userRepository: BaseRepository<!-- raw HTML omitted -->,<br>
private readonly em: EntityManager,<br>
private readonly authService: AuthService,  ) {}</p>
<p>/**<br>
* This function creates a new user with email, password, and metadata, persists it to the database,<br>
* and returns a sign-in response for the newly created user.<br>
* @param {SignInUserDto} signUpUser - The parameter `signUpUser` is of type `SignInUserDto`, which<br>
* is likely a data transfer object containing information about a user signing up for an account,<br>
* such as their email and password.<br>
* @returns The function `signUpUser` returns a Promise that resolves to a `SignInResponse` object.<br>
*/<br>
async signUpUser(signUpUser: SignInUserDto): Promise&lt;SignInResponse&gt; {<br>
const newUser = this.userRepository.create({<br>
email: signUpUser.email,<br>
password: signUpUser.password,<br>
metaData: this.INITIAL_BUDGET_METADATA,<br>
});<br>
await this.em.persistAndFlush(newUser);<br>
return await this.signInUser({<br>
email: signUpUser.email,<br>
password: signUpUser.password,<br>
});<br>
}</p>
<p>/**<br>
* This function retrieves a user&rsquo;s profile by their ID and throws an exception if the user is not<br>
* found.<br>
* @param {string} userId - The `userId` parameter is a string that represents the unique identifier of<br>
* a user. It is used to search for a user&rsquo;s profile in the database.<br>
* @returns The function `getUserProfile` returns a Promise that resolves to a `User` object.<br>
*/<br>
async getUserProfile(userId: string): Promise&lt;User&gt; {<br>
const userProfile = await this.userRepository.findOne({<br>
id: userId,<br>
});<br>
if (!userProfile) throw new NotFoundException(&lsquo;User not found&rsquo;);<br>
return userProfile;<br>
}</p>
<p>}</p>
<p><a href="https://docs.nestjs.com/" title="https://docs.nestjs.com/"><strong>Leanr more aboutDependency injection</strong><br>
_Nest is a framework for building efficient, scalable Node.js server-side applications. It uses progressive JavaScript‚Ä¶_docs.nestjs.com</a><a href="https://docs.nestjs.com/"></a></p>
<p>These are the building block of nestjs but there are many other types of classes in nestjs, some of them are disscussed below in brief</p>
<p>Before we move into other classes, please remember this peice of information from nestjs</p>
<p><img src="/Users/nirjalpaudel/Downloads/me/posts/md_1717232175977/img/1__ZQrQHAlCeGR8adP2D6UPKQ.png" alt=""></p>
<p><strong>3. Guards</strong></p>
<ul>
<li>Use for authorizing user</li>
<li>implements CanActivate Interface</li>
<li>logic in canActivate method</li>
<li>returns <code>boolean | Promise&lt;boolean&gt; | Observable&lt;boolean&gt;</code></li>
<li>proceeds to next part of lifecycle on truthy result</li>
<li>apply globally or use @UseGuards() method</li>
</ul>
<p>// example of guard thats accepts only medium authorization<br>
@Injectable()<br>
export class MediumGuard implements CanActivate {<br>
constructor() {}</p>
<p>async canActivate(context: ExecutionContext): Promise&lt;boolean&gt; {<br>
const request = context.switchToHttp().getRequest();<br>
const token = this.extractTokenFromHeader(request);<br>
if (!token) {<br>
throw new UnauthorizedException();<br>
}<br>
try {<br>
if (token!==&ldquo;medium&rdquo;)<br>
throw UnAuthorizedException(&ldquo;Use medium üòâ&rdquo;)<br>
} catch {<br>
throw new UnauthorizedException();<br>
}<br>
return true;<br>
}</p>
<p><strong>4. Interceptors</strong></p>
<ul>
<li>use for modifying request or response</li>
<li>implements NestInterceptor</li>
<li>logic in intercept method</li>
<li>must know RxJS</li>
<li>apply it globally or use @UseInterceptors() method</li>
</ul>
<p>import { Injectable, NestInterceptor, ExecutionContext, CallHandler } from &lsquo;@nestjs/common&rsquo;;<br>
import { Observable } from &lsquo;rxjs&rsquo;;<br>
import { tap } from &lsquo;rxjs/operators&rsquo;;</p>
<p>// a simple logging interceptor<br>
@Injectable()<br>
export class LoggingInterceptor implements NestInterceptor {<br>
intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {<br>
console.log(&lsquo;Before&hellip;&rsquo;);</p>
<pre><code>const now = Date.now();  
return next  
  .handle()  
  .pipe(  
    tap(() =&gt; console.log(\`After... ${Date.now() - now}ms\`)),  
  );  
</code></pre>
<p>}<br>
}</p>
<p><strong>5. Pipes</strong></p>
<ul>
<li>Use for validation/transformation of controller params</li>
<li><a href="https://docs.nestjs.com/pipes#built-in-pipes">Use builtin pipes for validation</a> by providing</li>
<li>Provide as second parameter to @Param(), @Body() or @Query() or use globally,</li>
<li>For custom Pipe,</li>
<li>create a class which implements PipeTransform</li>
<li>custom logic in transform method</li>
</ul>
<p>import { ArgumentMetadata, Injectable, PipeTransform } from &ldquo;@nestjs/common&rdquo;;</p>
<p>// a simple comma seperated string value to array transform pipe<br>
@Injectable()<br>
export class ParseCommaSeparatedPipe&lt;I extends string, J&gt;<br>
implements PipeTransform<br>
{<br>
commaRegex = /[,]/;</p>
<p>transform(value: I, metadata: ArgumentMetadata): J[] {<br>
if (value.length === 0) return [];</p>
<pre><code>return value.split(&quot;,&quot;).map((item) =&gt; item as J);  
</code></pre>
<p>}<br>
}</p>
<p><strong>6. Filters</strong></p>
<ul>
<li>can be though of as a catch block like in cpp or python</li>
<li>can be generic catch or specific catch</li>
<li>code in catch() method</li>
<li>Decorated by Catch decorator which takes HttpException</li>
</ul>
<p>import { ExceptionFilter, Catch, ArgumentsHost, HttpException } from &lsquo;@nestjs/common&rsquo;;<br>
import { Request, Response } from &rsquo;express&rsquo;;</p>
<p>@Catch(HttpException)<br>
export class HttpExceptionFilter implements ExceptionFilter {<br>
catch(exception: HttpException, host: ArgumentsHost) {<br>
const ctx = host.switchToHttp();<br>
const response = ctx.getResponse&lt;Response&gt;();<br>
const request = ctx.getRequest&lt;Request&gt;();<br>
const status = exception.getStatus();</p>
<pre><code>response  
  .status(status)  
  .json({  
    statusCode: status,  
    timestamp: new Date().toISOString(),  
    path: request.url,  
  });  
</code></pre>
<p>}<br>
}</p>
<p>There are many other types of classes in nestjs. which you can find in the official docs. I do nestjs most of the time and make sure you respond with what I left here. I may do part 2 and may write many things on nestjs. if you love it.</p>
<p><a href="https://docs.nestjs.com/" title="https://docs.nestjs.com/"><strong>Documentation | NestJS - A progressive Node.js framework</strong><br>
_Nest is a framework for building efficient, scalable Node.js server-side applications. It uses progressive JavaScript‚Ä¶_docs.nestjs.com</a><a href="https://docs.nestjs.com/"></a></p>
<p>I like to write about technology and programming on LinkedIn. So, let‚Äôs get connected there. Here are my socials where you can follow me.</p>
<p><a href="https://www.linkedin.com/in/nirjalpaudel/">https://www.linkedin.com/in/nirjalpaudel/</a><br>
<a href="https://github.com/n1rjal/">https://github.com/n1rjal/</a></p>
<h3 id="in-plainenglish">In Plain¬†English</h3>
<p><em>Thank you for being a part of our community! Before you go:</em></p>
<ul>
<li><em>Be sure to</em> <strong><em>clap</em></strong> <em>and</em> <strong><em>follow</em></strong> <em>the writer! üëè</em></li>
<li><em>You can find even more content at</em> <a href="https://plainenglish.io/"><strong><em>PlainEnglish.io</em></strong></a> <strong><em>üöÄ</em></strong></li>
<li><em>Sign up for our</em> <a href="http://newsletter.plainenglish.io/"><strong><em>free weekly newsletter</em></strong></a><em>. üóûÔ∏è</em></li>
<li><em>Follow us on</em> <a href="https://twitter.com/inPlainEngHQ"><strong><em>Twitter</em></strong></a><strong><em>(X</em></strong>), <a href="https://www.linkedin.com/company/inplainenglish/"><strong><em>LinkedIn</em></strong></a>, <a href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw"><strong><em>YouTube</em></strong></a>, and <a href="https://discord.gg/XxRS92b2"><strong><em>Discord</em></strong></a><strong><em>.</em></strong></li>
</ul>
</section>

  
  

  
  
  
  
  

  
  

  
  

  


  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="http://localhost:1313/">My New Hugo Site</a>
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >Powered by HugoÔ∏èÔ∏è</a
  >Ô∏è
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >‚úé Paper</a
  >
</footer>

  </body>
</html>
